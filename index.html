<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>BIET Nature Protection - Advanced DS Tracker</title>
    <style>
        body { font-family: 'Segoe UI', sans-serif; background: #eef2f3; padding: 20px; display: flex; flex-direction: column; align-items: center; }
        .container { width: 90%; max-width: 800px; background: white; padding: 20px; border-radius: 15px; shadow: 0 10px 25px rgba(0,0,0,0.1); }
        .grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px; margin-top: 20px; }
        .card { padding: 15px; border-radius: 10px; border: 2px solid #ddd; background: #fafafa; }
        .active-pattern { border-color: #27ae60; background: #edffef; box-shadow: 0 0 10px rgba(39,174,96,0.3); }
        .ds-badge { background: #34495e; color: white; padding: 3px 8px; border-radius: 5px; font-size: 0.9em; }
        input { padding: 12px; border-radius: 5px; border: 1px solid #ccc; width: 100px; }
        button { padding: 12px 20px; background: #2c3e50; color: white; border: none; border-radius: 5px; cursor: pointer; }
        .history-bar { margin: 20px 0; padding: 10px; background: #34495e; color: white; border-radius: 5px; width: 100%; overflow-x: auto; }
    </style>
</head>
<body>

<div class="container">
    <h2>Advanced Terminal DS Predictor</h2>
    
    <div style="display: flex; gap: 10px; justify-content: center;">
        <input type="number" id="spinInput" placeholder="Spin" min="0" max="36">
        <button onclick="handleSpin()">Track Spin</button>
    </div>

    <div class="history-bar" id="history">History: No spins recorded</div>

    <div class="grid" id="predictionGrid">
        </div>
</div>

<script>
    let spins = [];
    const terminalMap = {
        1: [8], 2: [7, 9], 3: [8], 4: [11], 5: [10, 12], 6: [11], 7: [2, 9],
        8: [1, 3, 13, 15], 9: [2, 14], 10: [5, 17], 11: [4, 6, 16, 18],
        12: [5, 17], 13: [8, 20], 14: [7, 9, 19, 21], 15: [8, 20], 16: [11, 23],
        17: [10, 12, 22, 24], 18: [11, 23], 19: [14, 26], 20: [13, 15, 25, 27],
        21: [14, 26], 22: [17, 29], 23: [16, 18, 28, 30], 24: [17, 29],
        25: [20, 32], 26: [19, 21, 31, 33], 27: [20, 32], 28: [23, 35],
        29: [22, 24, 34, 36], 30: [23, 35], 31: [26], 32: [25, 27],
        33: [26], 34: [29], 35: [28, 30], 36: [29]
    };

    function getDS(num) { return num === 0 ? 0 : Math.ceil(num / 6); }

    function handleSpin() {
        const val = parseInt(document.getElementById('spinInput').value);
        if (isNaN(val) || val < 0 || val > 36) return;
        
        spins.push(val);
        document.getElementById('spinInput').value = '';
        updateUI();
    }

    function updateUI() {
        document.getElementById('history').innerText = "History: " + spins.join(" - ");
        if (spins.length < 2) return;

        const last = spins[spins.length - 1];
        const prev = spins[spins.length - 2];
        const grid = document.getElementById('predictionGrid');
        grid.innerHTML = '';

        const ops = [
            { name: "Only (-)", res: Math.abs(last - prev) },
            { name: "Only (- & -1)", res: Math.abs(last - prev) - 1 },
            { name: "Only (- & +1)", res: Math.abs(last - prev) + 1 },
            { name: "Only (+)", res: (last + prev) },
            { name: "Only (+ & -1)", res: (last + prev) - 1 },
            { name: "Only (+ & +1)", res: (last + prev) + 1 }
        ];

        ops.forEach(op => {
            if (op.res > 0 && op.res <= 36) {
                const terminals = terminalMap[op.res] || [];
                const streets = [...new Set(terminals.map(t => getDS(t)))];
                
                const card = document.createElement('div');
                card.className = 'card';
                // Pattern following logic: check if last number was in this prediction
                if (terminals.includes(last)) card.classList.add('active-pattern');

                card.innerHTML = `
                    <strong>${op.name}</strong><br>
                    Delta: ${op.res}<br>
                    Terminals: ${terminals.join(', ')}<br>
                    <div style="margin-top:10px;">
                        ${streets.map(s => `<span class="ds-badge">DS ${s}</span>`).join(' ')}
                    </div>
                `;
                grid.appendChild(card);
            }
        });
    }
</script>
</body>
</html>
